<%= form_with(model: order, local: true, class: 'form-horizontal') do |form| %>
  <% if order.errors.any? %>
    <div id="error_explanation">
      <ul>
      <% order.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <div class="field">
      <%= form.label :prospect_id, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.select :prospect_id, @prospects.map{|p| [p.title, p.id]}, { include_blank: true }, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :estimate_id, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.select :estimate_id, @estimates.map{|e| [e.title, e.id]}, { include_blank: true }, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :title, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.text_field :title, id: :order_title, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :customer_id, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.select :customer_id, @customers.map{|c| [c.name, c.id]}, {}, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :order_no, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.text_field :order_no, id: :order_order_no, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :issue_date, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.date_field :issue_date, id: :order_issue_date, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :due_date, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.date_field :due_date, id: :order_due_date, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :payment_term, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.text_field :payment_term, id: :order_payment_term, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :tax_rate, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.text_field :tax_rate, id: :order_tax_rate, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :remarks, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.text_area :remarks, id: :order_remarks, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :user_profile_id, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.select :user_profile_id, @user_profiles.map{|u| [u.name, u.id]}, {}, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <div class="field">
      <%= form.label :submitted_flag, class: 'control-label col-sm-1' %>
      <div class="col-sm-5">
        <%= form.check_box :submitted_flag, id: :order_submitted_flag, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="details col-sm-12">
    <%= link_to_add_association t('.add_detail'), form, :order_details,
      data: {
        association_insertion_node: '#order_details',
        association_insertion_method: 'append'
      }
    %>
    <table>
      <thead>
        <tr>
          <th class="col-sm-1"><%= t('activerecord.attributes.order_detail.display_order') %></th>
          <th class="col-sm-2"><%= t('activerecord.attributes.order_detail.product_id') %></th>
          <th class="col-sm-2"><%= t('activerecord.attributes.order_detail.product_name') %></th>
          <th class="col-sm-1"><%= t('activerecord.attributes.order_detail.quantity') %></th>
          <th class="col-sm-2"><%= t('activerecord.attributes.order_detail.unit_price') %></th>
          <th class="col-sm-2"><%= t('activerecord.attributes.order_detail.price') %></th>
          <th class="col-sm-1"></th>
        </tr>
      </thead>
      <tbody id="order_details">
        <%= form.fields_for :order_details do |detail| %>
          <%= render 'order_detail_fields', f: detail %>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="form-group">
    <div class="col-sm-1"></div>
    <div class="actions">
      <%= form.submit class: 'btn btn-primary col-sm-1' %>
    </div>
  </div>
<% end %>
